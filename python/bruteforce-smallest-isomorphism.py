# Released under Apache 2.0; refer to LICENSE.txt

from customtree import *
from IntegerPartitions import *

# find distributions for which Q_{K_1} \neq Q_{K_2},
# but ALDR[P, K_1] = ALDR[P, K_2].
# there are many examples!

brk = False
for m in range(2,64):
    k = (m-1).bit_length()
    if ((1<<k)-m).bit_count() == 1:
        continue
    for A in revlex_partitions(m):
        if len(A) == 1:
            continue
        g = math.gcd(*A)
        if g != 1:
            continue
        cost0 = cost = get_tree_entropy(gen_fldr_tree(A, max_depth=k))
        entropy = H(A)
        for K in range(k+1,k*2+1):
            if ((1<<K)//m).bit_count() == 1:
                continue
            cost = get_tree_entropy(gen_fldr_tree(A, max_depth=K))
            if abs(cost-cost0) < 1e-6:
                print(f"m={m}, k={k}, K={K}, cost={cost}, entropy={entropy}, A={A}", flush=True)

# m=13, k=4, K=7, cost=2.3076923076923075, entropy=0.39124356362925555, A=[12, 1]
# m=13, k=4, K=7, cost=2.6153846153846154, entropy=0.779349837292085, A=[10, 3]
# m=13, k=4, K=7, cost=2.6153846153846154, entropy=0.9912642605354288, A=[10, 2, 1]
# m=13, k=4, K=7, cost=2.769230769230769, entropy=1.1451104143815827, A=[10, 1, 1, 1]
# m=13, k=4, K=7, cost=2.3076923076923075, entropy=0.9612366047228759, A=[8, 5]
# m=13, k=4, K=7, cost=2.3076923076923075, entropy=1.2389012566026307, A=[8, 4, 1]
# m=13, k=4, K=7, cost=2.6153846153846154, entropy=1.3346791410515946, A=[8, 3, 2]
# m=13, k=4, K=7, cost=2.769230769230769, entropy=1.4885252948977483, A=[8, 3, 1, 1]
# m=13, k=4, K=7, cost=2.6153846153846154, entropy=1.5465935642949384, A=[8, 2, 2, 1]
# m=13, k=4, K=7, cost=2.769230769230769, entropy=1.7004397181410922, A=[8, 2, 1, 1, 1]
# m=13, k=4, K=7, cost=2.923076923076923, entropy=1.8542858719872461, A=[8, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.230769230769231, entropy=0.9957274520849256, A=[7, 6]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=1.2957378005380122, A=[7, 5, 1]
# m=13, k=4, K=7, cost=3.230769230769231, entropy=1.4195562985716133, A=[7, 4, 2]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=1.573402452417767, A=[7, 4, 1, 1]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=1.457265913623387, A=[7, 3, 3]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=1.6691803368667308, A=[7, 3, 2, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=1.8230264907128846, A=[7, 3, 1, 1, 1]
# m=13, k=4, K=7, cost=3.5384615384615383, entropy=1.7272486062639207, A=[7, 2, 2, 2]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=1.8810947601100747, A=[7, 2, 2, 1, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.0349409139562287, A=[7, 2, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.0, entropy=2.1887870678023824, A=[7, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.230769230769231, entropy=1.3143204867061786, A=[6, 6, 1]
# m=13, k=4, K=7, cost=3.230769230769231, entropy=1.4604846813131116, A=[6, 5, 2]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=1.6143308351592653, A=[6, 5, 1, 1]
# m=13, k=4, K=7, cost=3.230769230769231, entropy=1.5262349099495225, A=[6, 4, 3]
# m=13, k=4, K=7, cost=3.230769230769231, entropy=1.7381493331928664, A=[6, 4, 2, 1]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=1.89199548703902, A=[6, 4, 1, 1, 1]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=1.77585894824464, A=[6, 3, 3, 1]
# m=13, k=4, K=7, cost=3.5384615384615383, entropy=1.8339272176418302, A=[6, 3, 2, 2]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=1.987773371487984, A=[6, 3, 2, 1, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.141619525334138, A=[6, 3, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.5384615384615383, entropy=2.045841640885174, A=[6, 2, 2, 2, 1]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=2.199687794731328, A=[6, 2, 2, 1, 1, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.3535339485774815, A=[6, 2, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.0, entropy=2.5073801024236357, A=[6, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=1.5485806065228542, A=[5, 5, 3]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=1.760495029766198, A=[5, 5, 2, 1]
# m=13, k=4, K=7, cost=3.5384615384615383, entropy=1.9143411836123518, A=[5, 5, 1, 1, 1]
# m=13, k=4, K=7, cost=2.923076923076923, entropy=1.5766212201074912, A=[5, 4, 4]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=1.826245258402609, A=[5, 4, 3, 1]
# m=13, k=4, K=7, cost=3.230769230769231, entropy=1.8843135277997989, A=[5, 4, 2, 2]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=2.038159681645953, A=[5, 4, 2, 1, 1]
# m=13, k=4, K=7, cost=3.5384615384615383, entropy=2.1920058354921066, A=[5, 4, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=1.9220231428515728, A=[5, 3, 3, 2]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.075869296697727, A=[5, 3, 3, 1, 1]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=2.1339375660949167, A=[5, 3, 2, 2, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.2877837199410704, A=[5, 3, 2, 1, 1, 1]
# m=13, k=4, K=7, cost=4.0, entropy=2.441629873787224, A=[5, 3, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.5384615384615383, entropy=2.1920058354921066, A=[5, 2, 2, 2, 2]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=2.3458519893382603, A=[5, 2, 2, 2, 1, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.4996981431844145, A=[5, 2, 2, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.0, entropy=2.6535442970305683, A=[5, 2, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.153846153846154, entropy=2.807390450876722, A=[5, 1, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=2.923076923076923, entropy=1.8542858719872461, A=[4, 4, 4, 1]
# m=13, k=4, K=7, cost=3.230769230769231, entropy=1.95006375643621, A=[4, 4, 3, 2]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=2.103909910282364, A=[4, 4, 3, 1, 1]
# m=13, k=4, K=7, cost=3.230769230769231, entropy=2.161978179679554, A=[4, 4, 2, 2, 1]
# m=13, k=4, K=7, cost=3.3846153846153846, entropy=2.3158243335257076, A=[4, 4, 2, 1, 1, 1]
# m=13, k=4, K=7, cost=3.5384615384615383, entropy=2.4696704873718613, A=[4, 4, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=1.9877733714879837, A=[4, 3, 3, 3]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=2.199687794731328, A=[4, 3, 3, 2, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.3535339485774815, A=[4, 3, 3, 1, 1, 1]
# m=13, k=4, K=7, cost=3.5384615384615383, entropy=2.2577560641285177, A=[4, 3, 2, 2, 2]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=2.4116022179746714, A=[4, 3, 2, 2, 1, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.5654483718208256, A=[4, 3, 2, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.0, entropy=2.7192945256669794, A=[4, 3, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.5384615384615383, entropy=2.4696704873718613, A=[4, 2, 2, 2, 2, 1]
# m=13, k=4, K=7, cost=3.6923076923076925, entropy=2.623516641218015, A=[4, 2, 2, 2, 1, 1, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.777362795064169, A=[4, 2, 2, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.0, entropy=2.9312089489103226, A=[4, 2, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.153846153846154, entropy=3.0850551027564768, A=[4, 1, 1, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.153846153846154, entropy=2.2373974097831013, A=[3, 3, 3, 3, 1]
# m=13, k=4, K=7, cost=4.0, entropy=2.2954656791802917, A=[3, 3, 3, 2, 2]
# m=13, k=4, K=7, cost=4.153846153846154, entropy=2.4493118330264454, A=[3, 3, 3, 2, 1, 1]
# m=13, k=4, K=7, cost=4.3076923076923075, entropy=2.6031579868725996, A=[3, 3, 3, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.0, entropy=2.5073801024236357, A=[3, 3, 2, 2, 2, 1]
# m=13, k=4, K=7, cost=4.153846153846154, entropy=2.6612262562697895, A=[3, 3, 2, 2, 1, 1, 1]
# m=13, k=4, K=7, cost=4.3076923076923075, entropy=2.8150724101159432, A=[3, 3, 2, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.461538461538462, entropy=2.968918563962097, A=[3, 3, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.5654483718208256, A=[3, 2, 2, 2, 2, 2]
# m=13, k=4, K=7, cost=4.0, entropy=2.7192945256669794, A=[3, 2, 2, 2, 2, 1, 1]
# m=13, k=4, K=7, cost=4.153846153846154, entropy=2.873140679513133, A=[3, 2, 2, 2, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.3076923076923075, entropy=3.0269868333592873, A=[3, 2, 2, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.461538461538462, entropy=3.180832987205441, A=[3, 2, 1, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.615384615384615, entropy=3.334679141051595, A=[3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=3.8461538461538463, entropy=2.777362795064169, A=[2, 2, 2, 2, 2, 2, 1]
# m=13, k=4, K=7, cost=4.0, entropy=2.9312089489103226, A=[2, 2, 2, 2, 2, 1, 1, 1]
# m=13, k=4, K=7, cost=4.153846153846154, entropy=3.0850551027564768, A=[2, 2, 2, 2, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.3076923076923075, entropy=3.2389012566026305, A=[2, 2, 2, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.461538461538462, entropy=3.3927474104487843, A=[2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.615384615384615, entropy=3.546593564294938, A=[2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
# m=13, k=4, K=7, cost=4.769230769230769, entropy=3.7004397181410917, A=[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
# ...
